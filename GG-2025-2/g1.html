<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Itinerario Interattivo: Da Milano ad Avenza</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* cool-gray-50 */
        }
        .timeline-item:not(:last-child)::before {
            content: '';
            position: absolute;
            left: 1.25rem; /* left-5 */
            top: 2.5rem; /* top-10 */
            width: 2px;
            height: calc(100% - 1.5rem);
            background-color: #e5e7eb; /* gray-200 */
            transform: translateX(-50%);
        }
        .timeline-icon {
            z-index: 10;
        }
        .completed {
            opacity: 0.6;
        }
        .completed label, .completed .type-label {
            text-decoration: line-through;
        }
        .tag {
            display: inline-flex;
            align-items: center;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
        }
    </style>
</head>
<body class="text-gray-800">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8">
        <!-- Navigation Buttons -->
        <nav class="mb-8 flex justify-between items-center">
            <a href="start.html" class="bg-indigo-500 text-white font-bold py-2 px-4 rounded-lg shadow-md hover:bg-indigo-600 transition duration-300 flex items-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z" />
                </svg>
                Home
            </a>
            <button onclick="history.back()" class="bg-gray-500 text-white font-bold py-2 px-4 rounded-lg shadow-md hover:bg-gray-600 transition duration-300 flex items-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd" />
                </svg>
                Indietro
            </button>
        </nav>

        <!-- Header -->
        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-bold text-gray-900">Itinerario: Da Milano ad Avenza</h1>
            <p class="mt-4 text-lg text-gray-600">Un viaggio tra storia, natura e sapori unici.</p>
        </header>

        <main class="grid grid-cols-1 lg:grid-cols-3 gap-12">
            
            <!-- Colonna Itinerario -->
            <div class="lg:col-span-2">
                <div class="flex items-baseline justify-between border-b-2 border-indigo-500 pb-2 mb-8">
                    <h2 class="text-3xl font-bold text-gray-900">Le Tappe del Viaggio</h2>
                    <span class="bg-indigo-100 text-indigo-800 text-lg font-semibold px-4 py-1 rounded-full">Giorno 1</span>
                </div>
                
                <!-- Partenza -->
                <div class="relative timeline-item pb-8">
                    <div class="timeline-icon absolute left-0 top-1 w-10 h-10 bg-green-500 text-white rounded-full flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" /></svg>
                    </div>
                    <div class="ml-16 bg-white p-6 rounded-lg shadow-md border border-gray-200">
                        <time class="text-sm font-semibold text-gray-500">07:30</time>
                        <h3 class="text-xl font-bold mt-1">Partenza da Milano</h3>
                    </div>
                </div>

                <!-- Arrivo a Scorcetoli -->
                <div class="relative timeline-item pb-8">
                    <div class="timeline-icon absolute left-0 top-1 w-10 h-10 bg-blue-500 text-white rounded-full flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" /></svg>
                    </div>
                    <div class="ml-16 bg-white p-6 rounded-lg shadow-md border border-gray-200">
                        <time class="text-sm font-semibold text-gray-500">10:30</time>
                        <h3 class="text-xl font-bold mt-1">Arrivo a Scorcetoli</h3>
                        <div class="mt-2 flex items-center text-sm text-indigo-600">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm3 2h6v4H7V5zm8 8H5v-2h10v2z" clip-rule="evenodd" /></svg>
                            <span>Filmatino (10 min)</span>
                        </div>
                    </div>
                </div>
                
                <!-- Tratta Scorcetoli - Avenza -->
                <div id="itinerary-list">
                    <!-- I dati verranno inseriti qui da JavaScript -->
                </div>

            </div>

            <!-- Colonna Cibo -->
            <div class="lg:col-span-1">
                <div class="sticky top-8">
                    <h2 class="text-3xl font-bold mb-8 border-b-2 border-amber-500 pb-2">Sapori della Lunigiana</h2>
                    
                    <div class="bg-white p-6 rounded-lg shadow-md border border-gray-200 mb-8">
                        <h3 class="text-2xl font-bold mb-4">Cibo e Bevande</h3>
                        <ul id="food-list" class="space-y-3">
                           <!-- I dati verranno inseriti qui da JavaScript -->
                        </ul>
                    </div>

                    <div class="bg-white p-6 rounded-lg shadow-md border border-gray-200">
                        <h3 class="text-2xl font-bold mb-4">Piatti Tipici</h3>
                        <ul id="dishes-list" class="space-y-3">
                           <!-- I dati verranno inseriti qui da JavaScript -->
                        </ul>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const itineraryData = [
                { type: 'sight', title: 'Fiume Magra', location: 'Lungo il percorso', tags: ['Opzionale'] },
                { type: 'poi', title: 'Pieve di Santo Stefano di Sorano', location: 'Filattiera', tags: ['Percorso spirituale', 'Storico'] },
                { type: 'poi', title: 'I mestieri del borgo', location: 'Ponticello di Filattiera', tags: ['Opzionale'] },
                { type: 'sight', title: 'Villafranca in Lunigiana e Torrente Bagnone', location: 'Villafranca in Lunigiana' },
                { type: 'poi', title: 'Fornoli', location: 'Fornoli - Villafranca in L.', note: 'Filmatino 5 min' },
                { type: 'poi', title: 'Aulla', location: 'Aulla', note: 'Filmatino 15 min', stamp: true },
                { type: 'poi', title: 'Castello Malaspina di Terrarossa', location: 'Terrarossa - Licciana Nardi' },
                { type: 'poi', title: 'Abbazia di San Caprasio', location: 'Aulla', description: 'Reliquie scoperte nel 2003', tags: ['Accoglienza', 'Storico'] },
                { type: 'poi', title: 'Bibola', location: 'Bibola - Aulla', description: 'Tau degli Ospitalieri', seal: true },
                { type: 'poi', title: 'Vecchietto', location: 'Vecchietto - Aulla', note: 'Filmatino 5 min' },
                { type: 'poi', title: 'Ponzano', location: 'Ponzano Magra', note: 'Filmatino 5 min', description: 'Passaggio Toscana/Liguria' },
                { type: 'poi', title: 'Sarzana', location: 'Sarzana', note: 'Filmatino 10 min', stamp: true },
                { type: 'poi', title: 'Concattedrale di Santa Maria Assunta', location: 'Duomo Sarzana', description: 'Il preziosissimo sangue' },
                { type: 'poi', title: 'Fortezza di Sarzanello', location: 'Sarzana', tags: ['Percorso Leggende / Storico'] },
                { type: 'poi', title: 'Luni', location: 'Luni', note: 'Filmatino 15 min' },
                { type: 'poi', title: 'Area archeologica di Luni', location: 'Luni', tags: ['Storico / Leggende'] },
                { type: 'poi', title: 'Avenza', location: 'Avenza - Carrara', note: 'Filmatino 10 min', stamp: true },
                { type: 'poi', title: 'La Torre di Castruccio Castracani', location: 'Avenza - Carrara', tags: ['Storico / Leggende'] }
            ];

            const foodData = [
                'Caciotta della Lunigiana', 'Cipolla di Treschietto', 'Fagiolo di Bigliolo', 'Vermentino Colli di Luni DOC', 'Paté di Lardo', 'Prosciutta Castelnovese', 'Lardo di Colonnata IGP', 'Mortadella Nostrale della Lunigiana', 'Fungo di Borgotaro IGP'
            ];

            const dishesData = [
                'Lasagne Bastarde', 'Testaroli (primo piatto)', 'Panigacci (Pane/focaccine)', 'Spongata di Sarzana (Dolce natalizio)', 'Taglierini nei fagioli'
            ];
            
            const itineraryList = document.getElementById('itinerary-list');
            const foodList = document.getElementById('food-list');
            const dishesList = document.getElementById('dishes-list');

            // --- Funzioni per creare le icone SVG ---
            const createIcon = (type) => {
                const icons = {
                    poi: `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" /></svg>`,
                    sight: `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" /></svg>`,
                    video: `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm3 2h6v4H7V5zm8 8H5v-2h10v2z" clip-rule="evenodd" /></svg>`,
                    stamp: `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z" /></svg>`,
                    seal: `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" /></svg>`
                };
                return icons[type] || '';
            };
            
            // --- Funzioni per creare i tag colorati ---
            const createTag = (tagText) => {
                let colorClass = 'bg-gray-200 text-gray-800';
                const lowerTag = tagText.toLowerCase();

                if (lowerTag.includes('opzionale')) return ''; // Gestito separatamente

                if (lowerTag.includes('storico / leggende') || lowerTag.includes('percorso leggende / storico')) colorClass = 'bg-orange-100 text-orange-800';
                else if (lowerTag.includes('storico')) colorClass = 'bg-red-100 text-red-800';
                else if (lowerTag.includes('spirituale')) colorClass = 'bg-purple-100 text-purple-800';
                else if (lowerTag.includes('accoglienza')) colorClass = 'bg-green-100 text-green-800';
                
                return `<span class="tag ${colorClass}">${tagText}</span>`;
            };

            // --- Popolamento Itinerario ---
            itineraryData.forEach((item, index) => {
                const isLast = index === itineraryData.length - 1;
                const timelineItemClass = isLast ? 'relative' : 'relative timeline-item pb-8';
                
                let locationHtml = '';
                if (item.location) locationHtml += `<p class="text-sm font-semibold text-gray-500">${item.location}</p>`;
                
                let typeLabelHtml = '';
                let optionalLabel = '';
                if (item.tags && item.tags.find(t => t.toLowerCase() === 'opzionale')) {
                    optionalLabel = `<span class="ml-2 text-sm font-bold text-blue-600 bg-blue-100 px-2 py-1 rounded-md border border-dashed border-blue-400">OPZIONALE</span>`;
                }

                if (item.type === 'sight') {
                    typeLabelHtml = `<div class="type-label text-sm font-bold text-teal-600 mt-2 mb-1 flex items-center">DA VEDERE ${optionalLabel}</div>`;
                } else if (item.type === 'poi') {
                    typeLabelHtml = `<div class="type-label text-sm font-bold text-blue-600 mt-2 mb-1 flex items-center">PUNTO DI INTERESSE ${optionalLabel}</div>`;
                }
                
                let notesHtml = '<div class="mt-3 flex flex-wrap items-center text-sm">';
                if (item.note) notesHtml += `<div class="flex items-center text-indigo-600 mr-4 mb-2">${createIcon('video')}<span>${item.note}</span></div>`;
                if (item.stamp) notesHtml += `<div class="flex items-center text-teal-600 mr-4 mb-2">${createIcon('stamp')}<span>Timbro</span></div>`;
                if (item.seal) notesHtml += `<div class="flex items-center text-rose-600 mr-4 mb-2">${createIcon('seal')}<span>Sigillo del TAU</span></div>`;
                notesHtml += '</div>';

                let tagsHtml = '<div class="mt-3 flex flex-wrap">';
                if (item.tags) {
                    item.tags.forEach(tag => tagsHtml += createTag(tag));
                }
                tagsHtml += '</div>';

                const iconBgColor = item.type === 'sight' ? 'bg-teal-500' : 'bg-blue-500';

                const html = `
                    <div class="${timelineItemClass}" data-item>
                        <div class="timeline-icon absolute left-0 top-1 w-10 h-10 ${iconBgColor} text-white rounded-full flex items-center justify-center">
                            ${createIcon(item.type)}
                        </div>
                        <div class="ml-16">
                            <div class="flex items-start justify-between bg-white p-6 rounded-lg shadow-md border border-gray-200">
                                <div class="flex-1">
                                    ${locationHtml}
                                    ${typeLabelHtml}
                                    <label for="item-${index}" class="text-xl font-bold cursor-pointer">${item.title}</label>
                                    ${item.description ? `<p class="mt-2 text-gray-600">${item.description}</p>` : ''}
                                    ${notesHtml.includes('<span>') ? notesHtml : ''}
                                    ${tagsHtml.includes('<span>') ? tagsHtml : ''}
                                </div>
                                <input type="checkbox" id="item-${index}" class="ml-4 mt-1 h-6 w-6 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500 cursor-pointer">
                            </div>
                        </div>
                    </div>
                `;
                itineraryList.innerHTML += html;
            });

            // --- Popolamento Cibo e Piatti ---
            const createFoodItem = (name, id) => `
                <li class="flex items-center" data-item>
                    <input type="checkbox" id="food-${id}" class="h-5 w-5 rounded border-gray-300 text-amber-600 focus:ring-amber-500 cursor-pointer">
                    <label for="food-${id}" class="ml-3 text-gray-700 cursor-pointer">${name}</label>
                </li>
            `;
            foodData.forEach((item, index) => foodList.innerHTML += createFoodItem(item, index));
            dishesData.forEach((item, index) => dishesList.innerHTML += createFoodItem(item, `dish-${index}`));

            // --- Aggiunta Interattività ---
            document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    const itemElement = this.closest('[data-item]');
                    if (this.checked) {
                        itemElement.classList.add('completed');
                    } else {
                        itemElement.classList.remove('completed');
                    }
                });
            });
        });
    </script>
</body>
</html>
